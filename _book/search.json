[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Documentação do Painel Gerencial CIGA",
    "section": "",
    "text": "Sobre\nEste documento apresenta um resumo da construção interna do Painel Gerencial CIGA. Nesse sentido, são abordados diversos temas relacionados ao back-end do Painel, incluindo as automatizações, repositórios, acesso e ambientes. Todas as informações aqui disponibilizadas fazem parte da construção das telas “Barragens”, “Informações sobre os TACs” e “Recomendações”.",
    "crumbs": [
      "Sobre"
    ]
  },
  {
    "objectID": "paineis.html",
    "href": "paineis.html",
    "title": "3  Painéis",
    "section": "",
    "text": "3.1 Home\nNesta seção, descrevemos os painéis que compõem o Painel Gerencial CIGA-MPMG.\nA home do Painel Gerencial CIGA-MPMG é a página acessada logo após o login. Seu objetivo é encaminhar o usuário para um dos painéis de dados: Barragens, Informações sobre os TACs, Descaracterização e Recomendações.\nO código fonte desta página se encontra no repositório painelMain.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Painéis</span>"
    ]
  },
  {
    "objectID": "paineis.html#estrutura-básica",
    "href": "paineis.html#estrutura-básica",
    "title": "3  Telas do Painel Gerencial CIGA",
    "section": "",
    "text": "Ubuntu 20.04\nR 4.2.1 ou superior\nShiny-Server em versão 1.5.19 ou superior\nVariáveis de ambiente:\n\nCIGA_SQL_HOST # endereço de acesso ao banco de dados\nCIGA_SQL_DATABASE # banco de dados\nCIGA_SQL_USER # usuário do banco\nCIGA_SQL_PORT # porta do banco\nCIGA_SQL_PASSWORD # senha\nAMBIENTE # stringr que deve ser \"homolog\" ou \"prod\"\nCIGA_OUTLOOK_TENANT # tenant do outlook\nCIGA_OUTLOOK_APP # id do aplicativo do outlook\nCIGA_OUTLOOK_PASSWORD # senha do outlook\nCIGA_FIREBASE_PASSWORD # senha de acesso ao firebase no usuario contato@ciga-mpmg.com.br\nCIGA_FIREBASE_PROJECT_API # projeto do firebase\n\nif (ambiente %in% c(\"homolog\", \"prod\")) {\n    url &lt;- get_golem_config(\"url\", Sys.getenv(\"AMBIENTE\"))\n    validation_endpoint &lt;- get_golem_config(\n      \"validation_endpoint\",\n      Sys.getenv(\"AMBIENTE\")\n    )\n    active_ui &lt;- painelLogin:::create_app_ui_auth(\n      request,\n      app_ui,\n      url,\n      validation_endpoint\n    )\n  } else {\n    active_ui &lt;- app_ui\n    url &lt;- NULL\n  }",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Telas do Painel Gerencial CIGA</span>"
    ]
  },
  {
    "objectID": "paineis.html#mecanismo-de-autenticação",
    "href": "paineis.html#mecanismo-de-autenticação",
    "title": "3  Telas do Painel Gerencial CIGA",
    "section": "3.2 Mecanismo de autenticação",
    "text": "3.2 Mecanismo de autenticação\nO mecanismo de autenticação de todo acesso se divide em dois casos: se há token de acesso nos cookies do usuário ou não. Se não houver, o fluxo de acesso é:\n\nInterromper o acesso ao app e expor a UI de login do painelLogin.\nA função validate_session usa o ToolKit do firebase para verificar se as credenciais são válidas.\nSe forem válidas, um token é devolvido paro usuário e salvo nos cookies.\nQuando as credenciais são válidas também é fornecido acesso ao painel.\n\n\nknitr::include_graphics(\"img/fluxoFirebase.png\")",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Telas do Painel Gerencial CIGA</span>"
    ]
  },
  {
    "objectID": "paineis.html#direcionamento-via-nginx",
    "href": "paineis.html#direcionamento-via-nginx",
    "title": "3  Telas do Painel Gerencial CIGA",
    "section": "3.3 Direcionamento via nginx",
    "text": "3.3 Direcionamento via nginx\nA compatibilização de todos os apps como uma única aplicação é feita com direcionamento via nginx. As configurações de location do nginx são:\n    location / {\n                # block added from rstudio support doc\n                proxy_pass http://localhost:3838;\n                proxy_redirect / $scheme://$http_host/;\n                proxy_http_version 1.1;\n                proxy_set_header Upgrade $http_upgrade;\n                proxy_set_header Connection $connection_upgrade;\n                proxy_read_timeout 20d;\n                proxy_buffering off;\n    }\nJá as configurações de redirecionamento são:\nserver {\n\n        listen 80;\n        server_name painel-homolog.ciga-mpmg.com.br;\n        rewrite     ^   https://$server_name$request_uri? redirect;\n\n        # Tamamho maximo de upload\n        #client_max_body_size 125m;\n\n        #proxy_headers_hash_max_size 2048;\n        #proxy_headers_hash_bucket_size 128;\n\n\n    location ^~ /.well-known/acme-challenge/ {\n         alias /var/www/html/.well-known/acme-challenge/;\n    }\n\n    location / {\n      proxy_pass http://127.0.0.1:3838/painelMain$request_uri;\n      proxy_redirect / $scheme://$http_host$request_uri;\n      proxy_http_version 1.1;\n      proxy_set_header Upgrade $http_upgrade;\n      proxy_set_header Connection $connection_upgrade;\n      proxy_read_timeout 20d;\n      proxy_buffering off;\n\n\n       # Websockets support\n  #      proxy_set_header Upgrade \"websocket\";\n  #      proxy_set_header Connection \"Upgrade\";\n\n    }\n\n    location /recomendacoes {\n      proxy_pass http://127.0.0.1:3838/painelRecomendacoes/;\n      proxy_redirect / $scheme://$http_host$request_uri;\n      proxy_http_version 1.1;\n      proxy_set_header Upgrade $http_upgrade;\n      proxy_set_header Connection $connection_upgrade;\n      proxy_read_timeout 20d;\n      proxy_buffering off;\n\n    }\n}\n\nserver {\n    listen 443 ssl;\n    server_name painel-homolog.ciga-mpmg.com.br;\n\n    ssl on;\n    ssl_certificate       /etc/letsencrypt/live/painel-homolog.ciga-mpmg.com.br/fullchain.pem;\n    ssl_certificate_key   /etc/letsencrypt/live/painel-homolog.ciga-mpmg.com.br/privkey.pem;\n\n    proxy_headers_hash_max_size 2048;\n    proxy_headers_hash_bucket_size 128;\n\n    location ^~ /.well-known/acme-challenge/ {\n         alias /var/www/html/.well-known/acme-challenge/;\n    }\n\n    location / {\n      proxy_pass http://127.0.0.1:3838/painelMain$request_uri;\n      proxy_redirect / $scheme://$http_host$request_uri;\n      proxy_http_version 1.1;\n      proxy_set_header Upgrade $http_upgrade;\n      proxy_set_header Connection $connection_upgrade;\n      proxy_read_timeout 20d;\n      proxy_buffering off;\n\n    error_page 404 500 502 /usr/share/nginx/html/custom_404.html;\n\n    }\n\n    location /recomendacoes/ {\n      proxy_pass http://127.0.0.1:3838/painelRecomendacoes/;\n      proxy_redirect / $scheme://$http_host$request_uri;\n      proxy_http_version 1.1;\n      proxy_set_header Upgrade $http_upgrade;\n      proxy_set_header Connection $connection_upgrade;\n      proxy_read_timeout 20d;\n      proxy_buffering off;\n\n    }\n\n    location /tacs/ {\n      proxy_pass http://127.0.0.1:3838/painelInfoTacs/;\n      proxy_redirect / $scheme://$http_host$request_uri;\n      proxy_http_version 1.1;\n      proxy_set_header Upgrade $http_upgrade;\n      proxy_set_header Connection $connection_upgrade;\n      proxy_read_timeout 20d;\n      proxy_buffering off;\n\n\n    }\n\n        location /barragens/ {\n      proxy_pass http://127.0.0.1:3838/painelBarragens/;\n      proxy_redirect / $scheme://$http_host$request_uri;\n      proxy_http_version 1.1;\n      proxy_set_header Upgrade $http_upgrade;\n      proxy_set_header Connection $connection_upgrade;\n      proxy_read_timeout 20d;\n      proxy_buffering off;\n\n\n    }\n\n        location /descaracterizacao/ {\n      proxy_pass http://127.0.0.1:3838/painelDescaracterizacao/;\n      proxy_redirect / $scheme://$http_host$request_uri;\n      proxy_http_version 1.1;\n      proxy_set_header Upgrade $http_upgrade;\n      proxy_set_header Connection $connection_upgrade;\n      proxy_read_timeout 20d;\n      proxy_buffering off;\n\n      error_page 404 500 502 /usr/share/nginx/html/custom_404.html;\n\n    }\n}",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Telas do Painel Gerencial CIGA</span>"
    ]
  },
  {
    "objectID": "bancos-de-dados.html",
    "href": "bancos-de-dados.html",
    "title": "2  Bancos de dados",
    "section": "",
    "text": "2.1 Banco de dados principal\nO banco de dados aecom_ciga_homolog contém diversas bases de dados de temas como: recomendações, sigbm, tabelas que deverão ser deletadas após parar de usar o Shinyapps, entre outros.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Bancos de dados</span>"
    ]
  },
  {
    "objectID": "bancos-de-dados.html#banco-de-dados-principal",
    "href": "bancos-de-dados.html#banco-de-dados-principal",
    "title": "2  Bancos de dados",
    "section": "",
    "text": "Importante\n\n\n\nEsse banco de dados tem “AECOM” no nome. O Rubem disse que isso não é desejável. Checar com a equipe da AECOM o que fazer sobre isso.\n\n\n\n2.1.1 Painéis que utilizam o banco de dados\nEsse banco de dados é utilizado nos seguintes painéis:\n\npainelRecomendacoes\npainelBarragens\n\n\n\n2.1.2 Tabelas no banco de dados\nSegue abaixo a lista de tabelas presentes no banco de dados aecom_ciga_homolog:\n\n\ncomarcasTJMG\ndados_recomendacoes_sigbm\ndados_recomendacoes_sigbm_complexo_minerario\ndados_sigbm_atualizacao_mensal\ndados_sigbm_linha_do_tempo\ndados_sigbm_linha_do_tempo_parcial\nentrepreneurs\nfull_recommendations\ngeography_columns\ngeometry_columns\ngeotechnical_structures\nide_sisema\nmetadados_documentos_tacs\nmetadados_imagens_satelite_bucket\nmetadados_imagens_satelite_bucket_local\nmetadados_mascaras_imagens_satelite_bucket\nmetadados_relatorios_gerenciais\npg_stat_statements\npg_stat_statements_info\nrecommendations3\nsigbm\nsigbm_atual\nsigbm_atual_com_comarcas\nsigbm_dados_cadastrais\nsigbm_dados_cadastrais_atual\nspatial_ref_sys\ntac_decharacterisations\ntacs\n\n\n\n\n2.1.3 Descrição das tabelas\nTabelas não utilizadas (são criadas pelo próprio sistema de banco de dados, e não são manipuladas/utilizadas no projeto):\ngeography_columns, geometry_columns, pg_stat_statements, pg_stat_statements_info, spatial_ref_sys.\nTabelas utilizadas:\n\ncomarcasTJMG:\n\nDescrição: Comarcas do TJMG.\nCriação: ETL feito pelo workflow download-comarcas-TJMG, no repositório ciga-mpmg/download_comarcas_TJMG. Depende do pacote comarcasTJMG.\nLeitura: scraper_sigbm.\n\nrecommendations3:\n\nDescrição: Tabela de recomendações emitidas para os TACs, por auditorias.\nCriação: Sistema de cadastro de TACs.\nLeitura: scraper_sigbm, relatorioGerencial.\n\nsigbm:\n\nDescrição: Tabela completa de informações extraídas da página principal do SIGBM, com informações sobre barragens no estado de Minas Gerais.\nCriação: ETL realizado no repositório scraper_sigbm.\nLeitura: scraper_sigbm, painelBarragens.\n\nsigbm_atual:\n\nDescrição: Tabela apenas com as informações mais recentes extraídas da página principal do SIGBM, com informações sobre barragens no estado de Minas Gerais.\nCriação: ETL realizado no repositório scraper_sigbm.\nLeitura: scraper_sigbm, painelBarragens.\n\nsigbm_atual_com_comarcas:\n\nDescrição: Tabela apenas com as informações mais recentes extraídas da página principal do SIGBM, com informações sobre barragens no estado de Minas Gerais, e suas respectivas comarcas.\nCriação: ETL realizado no repositório scraper_sigbm.\nLeitura: painelBarragens.\n\ndados_recomendacoes_sigbm:\n\nDescrição: União (join) feita a partir das tabelas recommendations3 e sigbm.\nCriação: repositório scraper_sigbm.\nLeitura: scraper_sigbm, painelRecomendacoes, relatorioGerencial.\n\ndados_recomendacoes_sigbm_complexo_minerario:\n\nDescrição: Resultado da união (join) da tabela com as recomendações, informações sobre o sigbm e informações sobre o complexo minerário.\nCriação: repositório scraper_sigbm.\nLeitura: painelRecomendacoes, googleStorageMetadata.\n\n\n\n\n\n\n\n\nImportante\n\n\n\n[JAN/2024] Me parece que antes esse fluxo era necessário pois as tabelas de complexo minerário estavam separadas. Agora, como vem com o banco, talvez seria bom reavaliar com calma se isso está fazendo sentido.\n\n\n\ndados_sigbm_atualizacao_mensal:\n\nDescrição: Tratamento da tabela sigbm para gerar a tabela de atualização mensal.\nCriação: repositório scraper_sigbm.\nLeitura: painelBarragens.\n\ndados_sigbm_linha_do_tempo e dados_sigbm_linha_do_tempo_parcial:\n\nDescrição: Tratamento da tabela sigbm para gerar linha do tempo.\nCriação: repositório scraper_sigbm.\nLeitura: painelBarragens.\n\nfull_recommendations:\n\nDescrição: ??\nCriação: ??\nLeitura: Nenhum\n\nide_sisema:\n\nDescrição: Dados do IDE SISEMA.\nCriação: download_IDE_SISEMA\nLeitura: Nenhum\n\nmetadados_documentos_tacs, metadados_imagens_satelite_bucket, metadados_imagens_satelite_bucket_local, metadados_mascaras_imagens_satelite_bucket, metadados_relatorios_gerenciais:\n\nDescrição: Metadados extraídos do Google Storage, com informações sobre os documentos dos TACs, imagens de satélite, relatórios gerenciais, etc.\nCriação: googleStorageMetadata.\nLeitura: painelBarragens, painelRecomendacoes.\n\nsigbm_dados_cadastrais e sigbm_dados_cadastrais_atual:\n\nDescrição: Dados extraídos da página completa do SIGBM, com informações sobre barragens no estado de Minas Gerais. Essa base de dados contém mais dados do que a base sigbm.\nCriação: ciga-monitoramento-info-barragens/sigbm-dados-cadastrais\nLeitura: Nenhum.\n\n\n\n\n\n\n\n\nTabelas que ainda são usadas no painel do Shinyapps, mas que agora usamos do banco de dadoscadastro-tacs e poderão ser deletadas futuramente do banco de dados aecom_ciga_homolog:\n\nentrepreneurs cópia antiga da tabela presente no banco de dados cadastro-tacs.\ngeotechnical_structures cópia antiga da tabela presente no banco de dados cadastro-tacs.\ntac_decharacterisations cópia antiga da tabela presente no banco de dados cadastro-tacs.\ntacs cópia antiga da tabela presente no banco de dados cadastro-tacs.\n\nATENÇÃO: Analisar se essas tabelas estão sendo utilizadas em algum lugar antes de deletá-las.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Bancos de dados</span>"
    ]
  },
  {
    "objectID": "bancos-de-dados.html#banco-de-dados-externo",
    "href": "bancos-de-dados.html#banco-de-dados-externo",
    "title": "2  Bancos de dados",
    "section": "2.2 Banco de dados externo",
    "text": "2.2 Banco de dados externo\nO banco de dados cadastro-tacs contém informações sobre os TACs (Termos de Ajustamento de Conduta) firmados pelo Ministério Público com empresas privadas.\nEsse banco de dados é utilizado nos seguintes repositórios:\n\nPainel Recomendações (ciga-mpmg/painelRecomendacoes)\n\n\n\n\n\n\n\nImportante\n\n\n\n[JAN/2024] O painelInfoTacs deveria usar os dados deste banco, certo? Conferir se está usando mesmo. Não apareceu na pesquisa do GitHub.\n[MAIO/2024] Conferi, e no código ele está conectando com a base de recomendações. Não está conectando com a base de cadastro de TACs. Isso precisará ser alterado.\n\n\nTabelas utilizadas:\n\n\n\n\n\n\n\ntacs: Tacs de estruturas geotécnicas (não são de descaracterização).\n\nUtilizada em: Painel Recomendações.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Bancos de dados</span>"
    ]
  },
  {
    "objectID": "workflows.html",
    "href": "workflows.html",
    "title": "3  Workflows com GitHub Actions",
    "section": "",
    "text": "Para executar a obtenção e a preparação dos utilizados nos painéis e outros produtos relacionados ao CIGA, existem diversos workflows que são executados pelo GitHub Actions.\nWorkflows são arquivos de configuração que definem um conjunto de ações que são executadas em um ambiente de execução. Em alguns casos, o ambiente de execução são máquinas virtuais pertencentes à GitHub, em outros, o servidor do próprio CIGA.\nOs workflows existentes, e as informações sobre eles, estão descritas no arquivo https://github.com/ciga-mpmg/painelActions/blob/main/README.md.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Workflows com GitHub Actions</span>"
    ]
  },
  {
    "objectID": "acesso.html",
    "href": "acesso.html",
    "title": "2  Acesso",
    "section": "",
    "text": "2.1 Login\nNesta seção, apresentamos informações sobre o acesso ao Painel Gerencial CIGA.\nPara acessar a versão em produção do Painel Gerencial CIGA, utilize a URL https://painel.ciga-mpmg.com.br/. A versão de homologação se encontra na URL https://painel-homolog.ciga-mpmg.com.br/.\nAmbas as versões necessitam de autenticação, sendo necessário cadastrar cada novo usuário no painel de gerenciamento do Firebase (firebase.google.com).",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Acesso</span>"
    ]
  },
  {
    "objectID": "acesso.html#cadastrar-novo-usuário",
    "href": "acesso.html#cadastrar-novo-usuário",
    "title": "2  Acesso",
    "section": "2.2 Cadastrar novo usuário",
    "text": "2.2 Cadastrar novo usuário\nO administrador do sistema CIGA pode cadastrar novos usuários interagindo com o painel de gerenciamento do Firebase:\n\nAo clicar em “Adicionar usuário”, basta incluir usuário e senha e o usuário estará criado com acesso ao Painel Gerencial, em sua versão de produção. Caso seja necessário fornecer acesso ao painel de homologação para teste de novas funcionalidades, é necessário definir homolog: true na entrada correspondente ao usuário recém-criado no RealTime Database:",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Acesso</span>"
    ]
  },
  {
    "objectID": "acesso.html#alterar-senha-remover-usuário-ou-suspender-acesso",
    "href": "acesso.html#alterar-senha-remover-usuário-ou-suspender-acesso",
    "title": "2  Acesso",
    "section": "2.3 Alterar senha, remover usuário ou suspender acesso",
    "text": "2.3 Alterar senha, remover usuário ou suspender acesso\nCaso seja necessário alterar uma dessas três características, basta interagir com os detalhamentos de um usuário no painel de gerenciamento do Firebase.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Acesso</span>"
    ]
  },
  {
    "objectID": "ambientes.html",
    "href": "ambientes.html",
    "title": "1  Ambientes",
    "section": "",
    "text": "1.1 R\nNesta seção, apresentamos os ambientes utilizados para a administração do Painel Gerencial CIGA.\nAs telas do Painel Gerencial CIGA foram desenvolvidas utilizando a linguagem de programação R e a biblioteca Shiny.\nPara alteração do código-fonte, será necessário instalar o R na máquina de desenvolvimento. Também é recomendado a utilização de alguma IDE amigável ao R, como o RStudio, o VSCode ou o Positron.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ambientes</span>"
    ]
  },
  {
    "objectID": "ambientes.html#github",
    "href": "ambientes.html#github",
    "title": "1  Ambientes",
    "section": "1.2 GitHub",
    "text": "1.2 GitHub\nO código-fonte das telas do Painel Gerencial CIGA e de suas automações foram versionados utilizando o sistema de controle de versão Git e estão disponíveis em repositórios privados no GitHub. Por sua vez, os repositórios foram criados dentro da organização ciga-mpmg.\nAlguns repositórios possuem processos automatizados (Actions) via Github Actions, como a atualização dos dados do SIGBM e o processo de atualização de versão dos painéis (deploy).\nNa Seção 5 listamos a função de cada repositório, os Actions que eles possuem e fornecemos seu respectivo link. Na Seção 6, descrevemos o que faz cada Action e como executá-los.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ambientes</span>"
    ]
  },
  {
    "objectID": "ambientes.html#gcp",
    "href": "ambientes.html#gcp",
    "title": "1  Ambientes",
    "section": "1.3 GCP",
    "text": "1.3 GCP\n(azeloc?)\nPara implantar o Painel Gerencial CIGA, foi necessário configurar uma máquina com as seguintes configurações:\n\nSistema operacional: Ubuntu 24.04\nCapacidade de disco: (azeloc?)\nMemória RAM: (azeloc?)\n\nTambém foi necessário instalar os seguintes softwares:\n\nR 4.2.1 ou superior\nShiny-Server em versão 1.5.19 ou superior\nnginx (azeloc?)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ambientes</span>"
    ]
  },
  {
    "objectID": "ambientes.html#shiny-server",
    "href": "ambientes.html#shiny-server",
    "title": "1  Ambientes",
    "section": "1.4 Shiny Server",
    "text": "1.4 Shiny Server\nAs telas do Painel Gerencial CIGA foram implantadas utilizando o Shiny Server.\nEste ambiente deverá ser acessado para… (azeloc?)\nApresentamos as configurações aplicadas ao Shiny Server para implantar o Painel Gerencial CIGA na Seção 7.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ambientes</span>"
    ]
  },
  {
    "objectID": "ambientes.html#firebase",
    "href": "ambientes.html#firebase",
    "title": "1  Ambientes",
    "section": "1.5 Firebase",
    "text": "1.5 Firebase\nO serviço Firebase é utilizado para a autenticação dos usuários do Painel CIGA-MPMG.\nO painel de gerenciamento do Firebase deverá ser utilizado para criar, alterar e rmover usuários do Painel CIGA-MPMG (veja a Seção 2). (azeloc?)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ambientes</span>"
    ]
  },
  {
    "objectID": "paineis.html#barragens",
    "href": "paineis.html#barragens",
    "title": "3  Painéis",
    "section": "3.2 Barragens",
    "text": "3.2 Barragens\nPossui visualizações e informações de barragens de rejeitos de mineração existentes no estado de Minas Gerais obtidas no Sistema de Gestão de Segurança de Barragem de Mineração (SIGBM), disponibilizado pela Agência Nacional de Mineração (ANM) e registradas na plataforma CIGA. As informações são atualizadas diariamente, de acordo com a base de dados do SIGBM.\nO código fonte desta página se encontra no repositório painelBarragens.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Painéis</span>"
    ]
  },
  {
    "objectID": "paineis.html#informações-sobre-os-tacs",
    "href": "paineis.html#informações-sobre-os-tacs",
    "title": "3  Painéis",
    "section": "3.3 Informações sobre os TACs",
    "text": "3.3 Informações sobre os TACs\nPossui acesso a informações detalhadas extraídas dos documentos jurídicos que balizam o Programa de Auditoria Técnica Independente, além de documentos técnicos enviados pelas Auditorias Técnicas no escopo dos Termos firmados entre o MPMG, MPF e mineradoras. Destaca-se que o termo TACs é aqui utilizado como uma generalização para acordos extrajudiciais como Termos de Compromisso, Termos de Ajustamento de Conduta e Termos de Compromisso Preliminar.\nO código fonte desta página se encontra no repositório painelInfoTacs.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Painéis</span>"
    ]
  },
  {
    "objectID": "paineis.html#descaracterização",
    "href": "paineis.html#descaracterização",
    "title": "3  Painéis",
    "section": "3.4 Descaracterização",
    "text": "3.4 Descaracterização\nPossui informações de acompanhamento dos TACs assinados pelos empreendedores responsáveis pelas barragens alteadas pelo método a montante ou desconhecido em Minas Gerais, com o objetivo de descaracterizar as barragens de mineração, que não atenderam ao prazo estipulado pela Lei “Mar de Lama Nunca Mais” (Lei Estadual nº 23.291/2019).\nO código fonte desta página se encontra no repositório painelDescaracterizacao.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Painéis</span>"
    ]
  },
  {
    "objectID": "paineis.html#recomendações",
    "href": "paineis.html#recomendações",
    "title": "3  Painéis",
    "section": "3.5 Recomendações",
    "text": "3.5 Recomendações\nPossui visualizações e estatísticas de acompanhamento de recomendações emitidas pelas Auditorias Técnicas Independentes, no contexto do cumprimento dos Termos de Ajustamento de Conduta (TACs) pelos empreendedores. Tais recomendações são primordialmente associadas a estruturas geotécnicas, mas envolvem também temas ligados ao meio ambiente, como bem-estar e manejo da fauna evacuada, monitoramento das águas na bacia do Rio Paraopeba, segurança hídrica no contexto do alto curso da bacia do Rio das Velhas, manejo de rejeitos na Bacia do Rio Doce, dentre outros temas.\nO código fonte desta página se encontra no repositório painelRecomendacoes.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Painéis</span>"
    ]
  },
  {
    "objectID": "paineis.html#home",
    "href": "paineis.html#home",
    "title": "3  Painéis",
    "section": "",
    "text": "Figura 3.1: Acesso aos painéis de dados do Painel Gerencial CIGA-MPMG",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Painéis</span>"
    ]
  },
  {
    "objectID": "repositorios.html",
    "href": "repositorios.html",
    "title": "5  Repositórios",
    "section": "",
    "text": "5.1 painelMain\nNesta seção, listamos e descrevemos todos os repositórios utilizados pelo Painel Gerencial CIGA-MPMG.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Repositórios</span>"
    ]
  },
  {
    "objectID": "repositorios.html#painelmain",
    "href": "repositorios.html#painelmain",
    "title": "5  Repositórios",
    "section": "",
    "text": "Descrição: contém o código-fonte da home do Painel Gerencial CIGA-MPMG (Seção 3.1), a página acessada logo após o login.\nLink: https://github.com/ciga-mpmg/painelMain\nActions: possui os Actions de deploy em homologação e produção de cada um dos painéis e para gerar os relatórios gerenciais.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Repositórios</span>"
    ]
  },
  {
    "objectID": "repositorios.html#painelbarragens",
    "href": "repositorios.html#painelbarragens",
    "title": "5  Repositórios",
    "section": "5.2 painelBarragens",
    "text": "5.2 painelBarragens\n\nDescrição: contém o código-fonte do painel Barragens (Seção 3.2).\nLink: https://github.com/ciga-mpmg/painelBarragens\nActions: não possui.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Repositórios</span>"
    ]
  },
  {
    "objectID": "repositorios.html#painelinfotacs",
    "href": "repositorios.html#painelinfotacs",
    "title": "5  Repositórios",
    "section": "5.3 painelInfoTacs",
    "text": "5.3 painelInfoTacs\n\nDescrição: contém o código-fonte do painel Informações sobre os TACs (Seção 3.3).\nLink: https://github.com/ciga-mpmg/painelInfoTacs\nActions: não possui.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Repositórios</span>"
    ]
  },
  {
    "objectID": "repositorios.html#paineldescaracterizacao",
    "href": "repositorios.html#paineldescaracterizacao",
    "title": "5  Repositórios",
    "section": "5.4 painelDescaracterizacao",
    "text": "5.4 painelDescaracterizacao\n\nDescrição: contém o código-fonte do painel Descaracterização (Seção 3.4).\nLink: https://github.com/ciga-mpmg/painelDescaracterizacao\nActions: não possui.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Repositórios</span>"
    ]
  },
  {
    "objectID": "repositorios.html#painelrecomendacoes",
    "href": "repositorios.html#painelrecomendacoes",
    "title": "5  Repositórios",
    "section": "5.5 painelRecomendacoes",
    "text": "5.5 painelRecomendacoes\n\nDescrição: contém o código-fonte do painel Recomendações (Seção 3.5).\nLink: https://github.com/ciga-mpmg/painelRecomendacoes\nActions: não possui.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Repositórios</span>"
    ]
  },
  {
    "objectID": "repositorios.html#painelassets",
    "href": "repositorios.html#painelassets",
    "title": "5  Repositórios",
    "section": "5.6 painelAssets",
    "text": "5.6 painelAssets\n\nDescrição: contém o código-fonte de um pacote R com funções auxiliares utilizadas em todos os painéis.\nLink: https://github.com/ciga-mpmg/painelAssets\nActions: não possui.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Repositórios</span>"
    ]
  },
  {
    "objectID": "repositorios.html#painellogin",
    "href": "repositorios.html#painellogin",
    "title": "5  Repositórios",
    "section": "5.7 painelLogin",
    "text": "5.7 painelLogin\n\nDescrição: contém o código-fonte de um pacote R com funções utilizadas na construção da camada de login via Firebase de cada Painel. Também possui o front-end da tela de Login.\nLink: https://github.com/ciga-mpmg/painelLogin\nActions: não possui.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Repositórios</span>"
    ]
  },
  {
    "objectID": "repositorios.html#painelrelatoriogerencial",
    "href": "repositorios.html#painelrelatoriogerencial",
    "title": "5  Repositórios",
    "section": "5.8 painelRelatorioGerencial",
    "text": "5.8 painelRelatorioGerencial\n\nDescrição: contém o código-fonte de todas as versões do Relatório Gerencial.\nLink: https://github.com/ciga-mpmg/painelRelatorioGerencial\nActions: não possui.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Repositórios</span>"
    ]
  },
  {
    "objectID": "repositorios.html#painelactions",
    "href": "repositorios.html#painelactions",
    "title": "5  Repositórios",
    "section": "5.9 painelActions",
    "text": "5.9 painelActions\n(azeloc?)",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Repositórios</span>"
    ]
  },
  {
    "objectID": "repositorios.html#paineldocumentacao",
    "href": "repositorios.html#paineldocumentacao",
    "title": "5  Repositórios",
    "section": "5.10 painelDocumentacao",
    "text": "5.10 painelDocumentacao\n\nDescrição: contém os arquivos que compõem esta documentação.\nLink: https://github.com/ciga-mpmg/painelDocumentacao\nActions: não possui.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Repositórios</span>"
    ]
  },
  {
    "objectID": "repositorios.html#scraper_sigbm",
    "href": "repositorios.html#scraper_sigbm",
    "title": "5  Repositórios",
    "section": "5.11 scraper_sigbm",
    "text": "5.11 scraper_sigbm\n(azeloc?)",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Repositórios</span>"
    ]
  },
  {
    "objectID": "paineis.html#sec-painel-home",
    "href": "paineis.html#sec-painel-home",
    "title": "3  Painéis",
    "section": "",
    "text": "Figura 3.1: Acesso aos painéis de dados do Painel Gerencial CIGA-MPMG",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Painéis</span>"
    ]
  },
  {
    "objectID": "paineis.html#sec-painel-barragens",
    "href": "paineis.html#sec-painel-barragens",
    "title": "3  Painéis",
    "section": "3.2 Barragens",
    "text": "3.2 Barragens\nPossui visualizações e informações de barragens de rejeitos de mineração existentes no estado de Minas Gerais obtidas no Sistema de Gestão de Segurança de Barragem de Mineração (SIGBM), disponibilizado pela Agência Nacional de Mineração (ANM) e registradas na plataforma CIGA. As informações são atualizadas diariamente, de acordo com a base de dados do SIGBM.\nO código fonte desta página se encontra no repositório painelBarragens.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Painéis</span>"
    ]
  },
  {
    "objectID": "paineis.html#sec-painel-infoTacs",
    "href": "paineis.html#sec-painel-infoTacs",
    "title": "3  Painéis",
    "section": "3.3 Informações sobre os TACs",
    "text": "3.3 Informações sobre os TACs\nPossui acesso a informações detalhadas extraídas dos documentos jurídicos que balizam o Programa de Auditoria Técnica Independente, além de documentos técnicos enviados pelas Auditorias Técnicas no escopo dos Termos firmados entre o MPMG, MPF e mineradoras. Destaca-se que o termo TACs é aqui utilizado como uma generalização para acordos extrajudiciais como Termos de Compromisso, Termos de Ajustamento de Conduta e Termos de Compromisso Preliminar.\nO código fonte desta página se encontra no repositório painelInfoTacs.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Painéis</span>"
    ]
  },
  {
    "objectID": "paineis.html#sec-painel-descaracterizacao",
    "href": "paineis.html#sec-painel-descaracterizacao",
    "title": "3  Painéis",
    "section": "3.4 Descaracterização",
    "text": "3.4 Descaracterização\nPossui informações de acompanhamento dos TACs assinados pelos empreendedores responsáveis pelas barragens alteadas pelo método a montante ou desconhecido em Minas Gerais, com o objetivo de descaracterizar as barragens de mineração, que não atenderam ao prazo estipulado pela Lei “Mar de Lama Nunca Mais” (Lei Estadual nº 23.291/2019).\nO código fonte desta página se encontra no repositório painelDescaracterizacao.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Painéis</span>"
    ]
  },
  {
    "objectID": "paineis.html#sec-painel-recomendacoes",
    "href": "paineis.html#sec-painel-recomendacoes",
    "title": "3  Painéis",
    "section": "3.5 Recomendações",
    "text": "3.5 Recomendações\nPossui visualizações e estatísticas de acompanhamento de recomendações emitidas pelas Auditorias Técnicas Independentes, no contexto do cumprimento dos Termos de Ajustamento de Conduta (TACs) pelos empreendedores. Tais recomendações são primordialmente associadas a estruturas geotécnicas, mas envolvem também temas ligados ao meio ambiente, como bem-estar e manejo da fauna evacuada, monitoramento das águas na bacia do Rio Paraopeba, segurança hídrica no contexto do alto curso da bacia do Rio das Velhas, manejo de rejeitos na Bacia do Rio Doce, dentre outros temas.\nO código fonte desta página se encontra no repositório painelRecomendacoes.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Painéis</span>"
    ]
  },
  {
    "objectID": "shiny_server.html",
    "href": "shiny_server.html",
    "title": "7  Shiny Server",
    "section": "",
    "text": "7.1 nginx\nNesta seção, apresentamos as configurações aplicadas ao Shiny Server para implantar o Painel CIGA-MPMG.\nA compatibilização de todos os apps como uma única aplicação é feita com direcionamento via nginx. As configurações de location do nginx são:\nJá as configurações de redirecionamento são:",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Shiny Server</span>"
    ]
  },
  {
    "objectID": "shiny_server.html#nginx",
    "href": "shiny_server.html#nginx",
    "title": "7  Shiny Server",
    "section": "",
    "text": "location / {\n  proxy_pass http://localhost:3838;\n  proxy_redirect / $scheme://$http_host/;\n  proxy_http_version 1.1;\n  proxy_set_header Upgrade $http_upgrade;\n  proxy_set_header Connection $connection_upgrade;\n  proxy_read_timeout 20d;\n  proxy_buffering off;\n}\n\nserver {\n  listen 80;\n  server_name painel-homolog.ciga-mpmg.com.br;\n  rewrite     ^   https://$server_name$request_uri? redirect;\n\n  location ^~ /.well-known/acme-challenge/ {\n        alias /var/www/html/.well-known/acme-challenge/;\n  }\n\n  location / {\n    proxy_pass http://127.0.0.1:3838/painelMain$request_uri;\n    proxy_redirect / $scheme://$http_host$request_uri;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection $connection_upgrade;\n    proxy_read_timeout 20d;\n    proxy_buffering off;\n  }\n\n  location /recomendacoes {\n    proxy_pass http://127.0.0.1:3838/painelRecomendacoes/;\n    proxy_redirect / $scheme://$http_host$request_uri;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection $connection_upgrade;\n    proxy_read_timeout 20d;\n    proxy_buffering off;\n  }\n}\n\nserver {\n  listen 443 ssl;\n  server_name painel-homolog.ciga-mpmg.com.br;\n\n  ssl on;\n  ssl_certificate       /etc/letsencrypt/live/painel-homolog.ciga-mpmg.com.br/fullchain.pem;\n  ssl_certificate_key   /etc/letsencrypt/live/painel-homolog.ciga-mpmg.com.br/privkey.pem;\n\n  proxy_headers_hash_max_size 2048;\n  proxy_headers_hash_bucket_size 128;\n\n  location ^~ /.well-known/acme-challenge/ {\n        alias /var/www/html/.well-known/acme-challenge/;\n  }\n\n  location / {\n    proxy_pass http://127.0.0.1:3838/painelMain$request_uri;\n    proxy_redirect / $scheme://$http_host$request_uri;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection $connection_upgrade;\n    proxy_read_timeout 20d;\n    proxy_buffering off;\n\n    error_page 404 500 502 /usr/share/nginx/html/custom_404.html;\n\n  }\n\n  location /recomendacoes/ {\n    proxy_pass http://127.0.0.1:3838/painelRecomendacoes/;\n    proxy_redirect / $scheme://$http_host$request_uri;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection $connection_upgrade;\n    proxy_read_timeout 20d;\n    proxy_buffering off;\n\n  }\n\n  location /tacs/ {\n    proxy_pass http://127.0.0.1:3838/painelInfoTacs/;\n    proxy_redirect / $scheme://$http_host$request_uri;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection $connection_upgrade;\n    proxy_read_timeout 20d;\n    proxy_buffering off;\n  }\n\n  location /barragens/ {\n    proxy_pass http://127.0.0.1:3838/painelBarragens/;\n    proxy_redirect / $scheme://$http_host$request_uri;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection $connection_upgrade;\n    proxy_read_timeout 20d;\n    proxy_buffering off;\n  }\n\n  location /descaracterizacao/ {\n    proxy_pass http://127.0.0.1:3838/painelDescaracterizacao/;\n    proxy_redirect / $scheme://$http_host$request_uri;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection $connection_upgrade;\n    proxy_read_timeout 20d;\n    proxy_buffering off;\n    error_page 404 500 502 /usr/share/nginx/html/custom_404.html;\n  }\n}",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Shiny Server</span>"
    ]
  },
  {
    "objectID": "shiny_server.html#variáveis-de-sistema",
    "href": "shiny_server.html#variáveis-de-sistema",
    "title": "7  Shiny Server",
    "section": "7.2 Variáveis de sistema",
    "text": "7.2 Variáveis de sistema\nPara o Painel conseguir acessar os serviços externos (e.g., Firebase e banco de dados), é necessário configurar as seguintes variáveis de ambiente no arquivo /home/shiny-admin/.Renviron:\n\nCIGA_SQL_HOST: endereço de acesso ao banco de dados\nCIGA_SQL_DATABASE: banco de dados\nCIGA_SQL_USER: usuário do banco\nCIGA_SQL_PORT: porta do banco\nCIGA_SQL_PASSWORD: senha\nAMBIENTE: string que deve ser “homolog” ou “prod”\nCIGA_OUTLOOK_TENANT: tenant do outlook\nCIGA_OUTLOOK_APP: id do aplicativo do outlook\nCIGA_OUTLOOK_PASSWORD: senha do outlook\nCIGA_FIREBASE_PASSWORD: senha de acesso ao firebase no usuario contato@ciga-mpmg.com.br\nCIGA_FIREBASE_PROJECT_API: projeto do firebase",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Shiny Server</span>"
    ]
  },
  {
    "objectID": "actions.html",
    "href": "actions.html",
    "title": "7  GitHub Actions",
    "section": "",
    "text": "6.1 Credenciais (repository secrets)\nPara executar a obtenção e a preparação dos utilizados nos painéis e outros produtos relacionados ao CIGA, existem diversos workflows que são executados pelo GitHub Actions.\nWorkflows são arquivos de configuração que definem um conjunto de ações que são executadas em um ambiente de execução. Em alguns casos, o ambiente de execução são máquinas virtuais pertencentes à GitHub, em outros, o servidor do próprio CIGA.\nNesta seção, descrevemos todos os workflows utilizados na manutenção do Painel Gerencial do CIGA-MPMG.\nCada workflow pode necessitar de diferentes credenciais. Abaixo estão listadas as credenciais necessárias para os workflows, segundo o serviço que ele utiliza.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>GitHub Actions</span>"
    ]
  },
  {
    "objectID": "actions.html#credenciais-repository-secrets",
    "href": "actions.html#credenciais-repository-secrets",
    "title": "6  Actions",
    "section": "",
    "text": "6.1.1 Banco de dados (GCP)\n\nCIGA_SQL_HOST\nCIGA_SQL_DATABASE\nCIGA_SQL_USER\nCIGA_SQL_PORT\nCIGA_SQL_PASSWORD\n\n\n\n6.1.2 Outlook (Conta Microsoft)\n\nCIGA_OUTLOOK_TENANT\nCIGA_OUTLOOK_PASSWORD\nCIGA_OUTLOOK_APP\n\n\n\n6.1.3 Firebase (GCP)\n\nCIGA_FIREBASE_PASSWORD\nCIGA_FIREBASE_PROJECT_API\n\n\n\n6.1.4 SSH (acesso ao servidor) (GCP)\n\nSSH_PRIVATE_KEY\nSSH_HOST\nSSH_USER\nSSH_PRIVATE_KEY_PROD\nSSH_HOST_PROD\n\n\n\n6.1.5 Google Cloud Storage (Bucket)\n\nCIGA_JSON_GOOGLE\n\n\n\n6.1.6 GitHub\n\nTOKEN",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Actions</span>"
    ]
  },
  {
    "objectID": "actions.html#workflows-relacionados-com-açõesside-effects",
    "href": "actions.html#workflows-relacionados-com-açõesside-effects",
    "title": "6  Actions",
    "section": "6.2 Workflows relacionados com ações/side-effects",
    "text": "6.2 Workflows relacionados com ações/side-effects\n\n6.2.1 Enviar emails de atualizações do SIGBM\n\nNível de urgência: ALTO\nDescrição: Envia email com atualizações do SIGBM. Emails com periodicidade diária, semanal ou mensal.\nExecução:\n\nAtivação manual\nAtivação automática: todos os dias, uma vez ao dia, às 7h30.\n\nRepositório: ciga-mpmg/painelEmailsSIGBM\nLink: workflow\nResultados:\n\nArquivos:\n\ndata/df_config_usuarios.rda - Dados dos usuários cadastrados no Firebase.\ndata/tabela_atualizacoes.rda - Tabela preparada com as atualizações do SIGBM.\n\nTabelas no banco de dados: Nenhuma tabela é alterada.\nAções: Os emails de atualizações são enviados.\n\nCredenciais necessárias:\n\nCIGA_SQL_HOST\nCIGA_SQL_DATABASE\nCIGA_SQL_USER\nCIGA_SQL_PORT\nCIGA_SQL_PASSWORD\nCIGA_OUTLOOK_TENANT\nCIGA_OUTLOOK_PASSWORD\nCIGA_OUTLOOK_APP\nCIGA_FIREBASE_PASSWORD\nCIGA_FIREBASE_PROJECT_API\n\n\n\n\n6.2.2 Gerar relatórios gerenciais padronizados\n\nNível de urgência: Baixo\nDescrição: Gera relatórios gerenciais padronizados - Alerta 7, Por TAC, por empreendedor, e por complexo minerário.\nExecução:\n\nAtivação manual\nAtivação automática: Dia 1 de cada mês, uma vez ao dia, às 00h00.\nAutomaticamente quando há novas modificações no repositório ciga-mpmg/resuvafeca\n\nRepositório:\nRepositório com o código para gerar o relatório: ciga-mpmg/relatorioGerencial\nRepositório onde o workflow é executado: ciga-mpmg/painelMain\n\nLink: workflow\nResultados:\n\nArquivos: relatórios em PDF, adicionados no Bucket, nas pastas bucket-aecom-ciga-homolog/relatorios_gerenciais_padronizados/TIPO_RELATORIO/YYYY-MM correspondente ao tipo de relatório e ao mês/ano.\nTabelas no banco de dados: Nenhuma tabela é alterada.\nAções: Relatórios são gerados no servidor e enviados para o Bucket.\n\nCredenciais necessárias:\n\nSSH_PRIVATE_KEY\nSSH_HOST\nSSH_USER\n\n\n\n\n6.2.3 Resuvafeca\n\nNível de urgência: Baixo\nDescrição: Sempre que houver novas alterações na branch main do repositório resuvafeca, ativa outros workflows:\n\nupdate-sigbm.yaml - atualizar sigbm\nciga-mpmg/relatorioGerencial - gerar relatório gerencial.\n\nExecução:\n\nAtivação automática: sempre que houver uma mudança na main do repositório.\n\nRepositório: ciga-mpmg/resuvafeca\nLink: workflow-dispatch-sigbm.yaml\nResultados:\n\nArquivos: Nenhum arquivo é gerado.\nTabelas no banco de dados: Nenhuma tabela é alterada.\nAções: Ativa outro workflows.\n\nCredenciais necessárias:\n\nTOKEN",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Actions</span>"
    ]
  },
  {
    "objectID": "actions.html#workflows-de-deploy",
    "href": "actions.html#workflows-de-deploy",
    "title": "6  Actions",
    "section": "6.3 Workflows de deploy",
    "text": "6.3 Workflows de deploy\n\n6.3.1 Atualizar o painel - Produção\n\nNível de urgência: Baixo\nDescrição: Workflow para atualizar o painel em produção. Atualiza todos os paineis. Atualiza o servidor com o código que está na branch prod de cada repositório dos painéis.\nExecução:\n\nAtivação automática: todos os dias, uma vez ao dia, às 00h00.\n\nRepositório: ciga-mpmg/painelMain\nLinks:\n\nworkflow\n\nResultados:\n\nArquivos: Nenhum arquivo é gerado.\nTabelas no banco de dados: Nenhuma tabela é alterada.\nAções: Atualizações dos painéis em produção.\n\nCredenciais necessárias:\n\nSSH_PRIVATE_KEY_PROD\nSSH_HOST_PROD\nSSH_USER\n\n\n\n\n6.3.2 Atualizar o painel - Homologação\n\nNível de urgência: Baixo\nDescrição: Workflow para o painel em homologação. Atualiza todos os paineis. Atualiza o servidor com o código que está na branch main de cada repositório dos painéis.\nExecução:\n\nAtivação automática: todos os dias, uma vez ao dia, às 01h00.\n\nRepositório: ciga-mpmg/painelMain\nLinks:\n\nworkflow\n\n\nResultados:\n\nArquivos: Nenhum arquivo é gerado.\nTabelas no banco de dados: Nenhuma tabela é alterada.\nAções: Atualizações dos painéis em homologação.\n\nCredenciais necessárias:\n\nSSH_PRIVATE_KEY\nSSH_HOST\nSSH_USER",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Actions</span>"
    ]
  },
  {
    "objectID": "actions.html#workflows-de-atualização-de-bases-de-dados",
    "href": "actions.html#workflows-de-atualização-de-bases-de-dados",
    "title": "6  Actions",
    "section": "6.4 Workflows de atualização de bases de dados",
    "text": "6.4 Workflows de atualização de bases de dados\n\n6.4.1 Download SIGBM\n\nNível de urgência: ALTO\nDescrição: Faz download dos dados do portal SIGBM. Além disso, faz um join da base do SIGBM com a base de recomendações, e outros tratamentos necessários para preparar tabelas para os painéis.\nExecução:\n\nAtivação automática: todos os dias, duas vezes ao dia, às 11h30 e 23h30.\n\nRepositório: ciga-mpmg/scraper_sigbm\nLink: update-sigbm.yaml\nResultados:\n\nArquivos:\n\ndata-raw/sigbm_diff.csv\ndata-raw/sigbm_mais_recente.csv\n\nTabelas no banco de dados:\n\nsigbm_atual\nsigbm\n\ndados_recomendacoes_sigbm\ndados_sigbm_atualizacao_mensal\ndados_sigbm_linha_do_tempo_parcial\ndados_sigbm_linha_do_tempo\ndados_recomendacoes_sigbm_complexo_minerario\nsigbm_atual_com_comarcas\n\n\nCredenciais necessárias:\n\nCIGA_SQL_HOST\nCIGA_SQL_DATABASE\nCIGA_SQL_USER\nCIGA_SQL_PORT\nCIGA_SQL_PASSWORD\n\nImportante: Executar sempre que uma nova atualização da base de recomendações acontecer! Essa execução acontece automaticamente quando há novas modificações no repositório ciga-mpmg/resuvafeca\nEsse workflow realiza diversas tarefas de ETL importantes para o painel, descritas no README do repositório.\nObservações:\n\nConforme feito aqui, a verificação de SSL foi desativada por um problema no site da ANM.\n\n\n\n\n6.4.2 Copiar metadados do bucket\n\nNível de urgência: ALTO\nDescrição: Importa informações de uma série de arquivos que estão no bucket, como: documentos dos TACs, relatórios gerenciais, imagens de satélite e as máscaras das imagens de satélite.\nExecução:\n\nAtivação automática: todos os dias, duas vezes ao dia, às 07h00 e 19h00.\n\nRepositório: ciga-mpmg/googleStorageMetadata\nLink: copia-metadados-bucket.yaml\nResultados:\n\nArquivos: Nenhum arquivo é gerado.\nTabelas no banco de dados:\n\nmetadados_documentos_tacs\n\nmetadados_relatorios_gerenciais\n\nmetadados_imagens_satelite_bucket\nmetadados_imagens_satelite_bucket_local\n\nmetadados_mascaras_imagens_satelite_bucket\n\n\nCredenciais necessárias:\n\nCIGA_SQL_HOST\nCIGA_SQL_DATABASE\nCIGA_SQL_USER\nCIGA_SQL_PORT\nCIGA_SQL_PASSWORD\nCIGA_JSON_GOOGLE\n\nImportante:\n\nSempre que fizer alguma mudança nos arquivos do bucket citados acima e quiser que essas mudanças apareçam no app, execute manualmente esse workflow.\nCaso adicione imagens de satélite novas, verifique se a mesma consta na tabela de-para de imagens de satélite e barragens: local e regional.\n\nConsulte o README do repositório para mais informações sobre o quais informações são extraídas.\n\n\n\n6.4.3 Download IDE SISEMA\n\nNível de urgência: Baixo\nDescrição: Faz download dos dados do IDE Sisema acessando o seu Web Map Server (WMS) (código por (rdornas?)).\nExecução:\n\nAtivação automática: todos os dias, uma vez ao dia, às 07h00.\n\nRepositório: ciga-mpmg/download_IDE_SISEMA\nLink: update-data.yaml\nResultados:\n\nArquivos: data-raw/ide_sisema.csv\nTabelas no banco de dados: ide_sisema\n\nCredenciais necessárias:\n\nCIGA_SQL_HOST\nCIGA_SQL_DATABASE\nCIGA_SQL_USER\nCIGA_SQL_PORT\nCIGA_SQL_PASSWORD\n\n\n\n\n6.4.4 Download Comarcas TJMG\n\nNível de urgência: Baixo\nDescrição: Faz download do pdf dos municípios e comarcas do Tribunal de Justiça do estado de Minas Gerais, trata e disponibiliza (código por (rdornas?) e (mayaradaher?) utilizado está disponível no repositório ciga-mpmg/comarcasTJMG).\nExecução:\n\nAtivação automática: todos os dias, uma vez ao dia, às 07h00.\n\nRepositório: ciga-mpmg/download_comarcas_TJMG\nLink: download-comarcas-TJMG\nResultados:\n\nArquivos: data-raw/comarcas_TJMG.csv\nTabelas no banco de dados: comarcasTJMG\n\nCredenciais necessárias:\n\nCIGA_SQL_HOST\nCIGA_SQL_DATABASE\nCIGA_SQL_USER\nCIGA_SQL_PORT\nCIGA_SQL_PASSWORD\n\n\n\n\n6.4.5 Download SIGBM detalhado\n\nNível de urgência: Médio\nDescrição: Faz o download dos dados detalhados do portal SIGBM.\nExecução:\n\nAtivação automática: todos os dias, uma vez ao dia, às 19h00.\n\nRepositório: ciga-monitoramento-info-barragens/sigbm-dados-cadastrais\nLink: update-sigbm-dados-cadastrais.yaml\nResultados:\n\nArquivos:\n\ndata-raw/chaves_mg.csv\ndata-raw/dados_brutos_mais_recente.csv\ndata-raw/dados_tratados_mais_recente.csv\ndata-raw/dados_tratados_diff.csv\ndata-raw/dados_tratados_descaracterizacao.csv\n\nTabelas no banco de dados:\n\nsigbm_dados_cadastrais_atual\nsigbm_dados_cadastrais\n\n\nCredenciais necessárias:\n\nCIGA_SQL_HOST\nCIGA_SQL_DATABASE\nCIGA_SQL_USER\nCIGA_SQL_PORT\nCIGA_SQL_PASSWORD\n\nObservações:\n\nConforme feito aqui, a verificação de SSL foi desativada por um problema no site da ANM.\n\n\n\n\n6.4.6 Download SIGBM detalhado - Mapa de inundação - Download\n\nNível de urgência: baixo\nDescrição: Faz o download dos mapas de inundação disponibilizados no portal SIGBM.\nExecução:\n\nAtivação automática: todos os dias, uma vez ao dia, às 20h00.\n\nRepositório: https://github.com/ciga-mpmg/sigbm-mapa-inundacao\nLink: 01-download-sigbm-mapa-inundacao-dados.yaml\nResultados:\n\nArquivos:\n\ndata-raw/chaves_mg.csv\ndata-raw/dados_mapa_inundacao.csv\ndata/dados_mapa_inundacao.rda\ndata-raw/arquivos_para_baixar.csv\n\nTabelas no banco de dados: Nenhuma tabela é alterada.\n\nCredenciais necessárias:\n\nCIGA_JSON_GOOGLE\n\n\n\n\n6.4.7 Download SIGBM detalhado - Mapa de inundação - Upload\n\nNível de urgência: baixo\nDescrição: Faz o upload dos mapas de inundação disponibilizados no portal SIGBM para o Bucket.\nExecução:\n\nAtivação automática: todos os dias, uma vez ao dia, às 20h30.\n\nRepositório: https://github.com/ciga-mpmg/sigbm-mapa-inundacao\nLink:\n\n02-upload-sigbm-mapa-inundacao-bucket.yaml\n\nResultados:\n\nArquivos:\n\ndata-raw/arquivos_para_baixar.csv\n\n\nTabelas no banco de dados: Nenhuma tabela é alterada.\n\nCredenciais necessárias:\n\nCIGA_JSON_GOOGLE",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Actions</span>"
    ]
  },
  {
    "objectID": "relatorio.html",
    "href": "relatorio.html",
    "title": "4  Relatório Gerencial",
    "section": "",
    "text": "4.1 Gerar relatórios gerenciais\nNesta seção, descrevemos os processos que envolvem a geração dos relatórios gerenciais do Painel CIGA-MPMG.\nPara gerar os relatórios gerenciais atualizados e disponibilizá-los para download na plataforma, você deve:\nPasso 1: Executar a rotina de geração dos relatórios “gerar_relatorios_gerenciais” clicando em “Run workflow” na página de Actions do repositório https://github.com/ciga-mpmg/painelMain\nAo final desse processo, novos relatórios referentes à data de execução da rotina serão criados.\nPasso 2: Executar a rotina de cadastros do relatórios no banco de dados interno da plataforma CIGA-MPMG.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Relatório Gerencial</span>"
    ]
  },
  {
    "objectID": "ambientes.html#google-cloud-platform",
    "href": "ambientes.html#google-cloud-platform",
    "title": "1  Ambientes",
    "section": "1.3 Google Cloud Platform",
    "text": "1.3 Google Cloud Platform\n(azeloc?)\nPara implantar o Painel Gerencial CIGA, foi necessário configurar uma máquina com as seguintes configurações:\n\nSistema operacional: Ubuntu 24.04.1 LTS\nCapacidade de disco: 20 Gb\nMemória RAM: 4 Gb\n\nTambém foi necessário instalar os seguintes softwares:\n\nR 4.2.1 ou superior\nShiny-Server em versão 1.5.19 ou superior\nnginx 1.26.2",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ambientes</span>"
    ]
  },
  {
    "objectID": "ambientes.html#google-firebase",
    "href": "ambientes.html#google-firebase",
    "title": "1  Ambientes",
    "section": "1.5 Google Firebase",
    "text": "1.5 Google Firebase\nO serviço Google Firebase é utilizado para a autenticação dos usuários do Painel CIGA-MPMG.\nO painel de gerenciamento do Firebase deverá ser utilizado para criar, alterar e rmover usuários do Painel CIGA-MPMG (veja a Seção 2). (azeloc?)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ambientes</span>"
    ]
  }
]
